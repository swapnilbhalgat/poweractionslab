name: create-environment
# Create environment in your tenant

on:
  workflow_dispatch:    # allow for manual workflow triggering as needed

jobs:
  create:
    runs-on: windows-latest
    env:
      RUNNER_DEBUG: 1

    steps:
    - uses: actions/checkout@v2
      with:
        lfs: true

      - name: create-environment action
        uses: microsoft/powerplatform-actions/create-environment@7cbffc7
        id: create-test-pizza
        with:
          user-name: 'sbhalgat@ppdevtools.onmicrosoft.com'
          password-secret: ${{ secrets.password }}
          name: newEnvironment
          type: Sandbox
          region: unitedstates
          domain: test-pizza

      - name: delete-environment action
        uses: microsoft/powerplatform-actions/create-environment@7cbffc7
        with:
          environment-url: ${{ steps.create-test-pizza.outputs.environment-url }}
          user-name: 'sbhalgat@ppdevtools.onmicrosoft.com'
          password-secret: ${{ secrets.PASSWORD_PPDEVTOOLS }}